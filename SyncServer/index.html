<!DOCTYPE html>
<html lang="en">
<!-- 
  QUICK REF LINK  
  https://developer.jwplayer.com/jwplayer/docs/jw8-javascript-api-reference
-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="https://cdn.jwplayer.com/libraries/NMuIi6sP.js"></script>

   <!-- <link rel="stylesheet" href="assets/style.css" />  -->
    <title>WebSockets</title>
</head>

<body>

<table>
<tr>
<td><h1>Payload Tests 1.6 </h1></td>
</tr>
  <tr>
    <td><input type="text" id="myText" name="myText"> </td>
    <td><input type="text" size="50" id="echoText" name="echoText" value="NoSocket"></td>
    <td><input type="text" size="20" id="timeBox"></td>
  </tr>
  <tr>
    <td><button type="button" onclick="sendMyText()">Send My Text</button></td>
    <td><button type="button" onclick="sendEchoText()">Send Group Text</button></td>
  </tr>
  <tr> <td>\n</td>   <td></td>  </tr>
  <tr>
    <td><button type="button" onclick="videoPlay()">Play</button>
      <button type="button" onclick="videoPause()">Pause</button>
      <button type="button" onclick="videoSync()">Sync All</button>
      <button type="button" onclick="joinRoom()">Join Room</button>
      </td>

    <td><input type="text" id="playState" name="playState"> </td>
  </tr>
</table>

<table>
<tr>
<td>
   <div class="video-player">

<div id="myElement">Player loading...</div>
 </div>
<a href="javascript:jwplayer('myElement').play();">Toggle playback</a>
<a href="javascript:alert('The volume of the player is: ' + jwplayer('myElement').getVolume());">Report volume</a>
   
</td>
</tr>
</table>

<!-- JW Player Code-->
<script type="text/JavaScript">
    jwplayer("myElement").setup({
	    "playlist": [{
      "file": "https://s3.amazonaws.com/counterbalance-video/stemc1.m4v"
      }],
//responsive: true,
//width: "50%",
//aspectratio: "16:9",
 //     width: 480,
   //  height: 270,
    autostart: true,
  //  mute: false,
  //  volume: 80,
      });

//jwplayer("myElement").on('ready');

   // jwplayer("myElement").resize(480, 470);
  // jwplayer("myElement").play(false);

    // Related to sticky play issue.
    // jwplayer("myElement").seek(1);
    //jwplayer("myElement").play();
</script>

 
<!-- WS Script Core Socket Code -->
 <script type="text/JavaScript">
    let startTime = Date.now();

    let ClientData = {
      "eventCode":"NEW",
      "clientTimeCode":0,
      "clientTimeStamp":0,
      "clientDate":startTime,
      "sendText":"na",
      }

    let ServerData = {
      "eventCode":"",
      "serverTimeCode":0,
      "serverTimeStamp":0,
      "echoText":"na",
      }

  //  const ws = new WebSocket("ws://ec2-18-237-232-102.us-west-2.compute.amazonaws.com:8082");
    const ws = new WebSocket("ws://localhost:8082");
    ws.addEventListener("open", ()=>{
      ClientData.eventCode="NEW";
      ClientData.sendText="Hello World: "+ClientData.clientDate;
      //ClientData.sendText=Date.now().toTimeString();
      let payload = JSON.stringify(ClientData); 
      ws.send(payload);

      //  ws.send("Hey hows it going");
      });


    ws.addEventListener("message",({data}) =>{      
      ServerData = JSON.parse(data);
      data = ServerData.eventCode;

      switch (ServerData.eventCode) {
        case 'PLAY':
          jwplayer("myElement").play();
          document.getElementById("playState").value = ServerData.eventCode;
          break; 
        case 'NEW':
          jwplayer("myElement").seek(ServerData.serverTimeCode);
       //   jwplayer("myElement").pause();
          jwplayer("myElement").play();
          document.getElementById("playState").value = ServerData.eventCode;
          document.getElementById("echoText").value = ServerData.echoText;
          break; 
        case 'PAUSE':
          jwplayer("myElement").pause();
          document.getElementById("playState").value = ServerData.eventCode;
          break;
        case 'SYNCALL':
          jwplayer("myElement").seek(ServerData.serverTimeCode);
          document.getElementById("timeBox").value = ServerData.serverTimeCode;
          jwplayer("myElement").pause();
          jwplayer("myElement").play();
          break;

        default:
          document.getElementById("echoText").value = ServerData.echoText;
        }
      });
 
    function sendMyText() {
      let currentTime = Date.now();
      ClientData.clientTimeStamp = currentTime - startTime;
      ClientData.clientDate;
      ClientData.sendText = document.getElementById("myText").value;
      let payload = JSON.stringify(ClientData);
      // let payload = document.getElementById("myText").value;
      ws.send(payload);
    }

    function sendEchoText() {
      ClientData.sendText = document.getElementById("echoText").value;
    
      let payload = JSON.stringify(ClientData);
    // let payload = document.getElementById("echoText").value;
      ws.send(payload);
    }

   function videoPlay() {
      ClientData.eventCode = "PLAY";
      let payload = JSON.stringify(ClientData);
      ws.send(payload);
    }

   function videoPause() {
      ClientData.eventCode = "PAUSE";
      let payload = JSON.stringify(ClientData);
      ws.send(payload);
    }

    function videoSync() {
      ClientData.eventCode = "SYNCALL";
      ClientData.clientTimeCode= jwplayer("myElement").getPosition();
      let payload = JSON.stringify(ClientData);
      ws.send(payload);
    }
  function joinRoom() {
      ClientData.eventCode = "NEW";
      let payload = JSON.stringify(ClientData);
      ws.send(payload);
    }


  </script>

 <!--
<script>
// Source for video Player
const videoPlayer = document.querySelector('.video-player')
const video = videoPlayer.querySelector('.video')
const playButton = videoPlayer.querySelector('.play-button')
const volume = videoPlayer.querySelector('.volume')
const currentTimeElement = videoPlayer.querySelector('.current')
const durationTimeElement = videoPlayer.querySelector('.duration')
const progress = videoPlayer.querySelector('.video-progress')
const progressBar = videoPlayer.querySelector('.video-progress-filled')


//Play and Pause button
playButton.addEventListener('click', (e) => {
  if(video.paused){
    video.play()
    e.target.textContent = '❚ ❚'
  } else {
    video.pause()
    e.target.textContent = '►'
  }
})

//volume
volume.addEventListener('mousemove', (e)=> {
  video.volume = e.target.value
})

//current time and duration
const currentTime = () => {
  let currentMinutes = Math.floor(video.currentTime / 60)
  let currentSeconds = Math.floor(video.currentTime - currentMinutes * 60)
  let durationMinutes = Math.floor(video.duration / 60)
  let durationSeconds = Math.floor(video.duration - durationMinutes * 60)

  currentTimeElement.innerHTML = `${currentMinutes}:${currentSeconds < 10 ? '0'+currentSeconds : currentSeconds}`
  durationTimeElement.innerHTML = `${durationMinutes}:${durationSeconds}`
}

video.addEventListener('timeupdate', currentTime)

//Progress bar
video.addEventListener('timeupdate', () =>{
  const percentage = (video.currentTime / video.duration) * 100
  progressBar.style.width = `${percentage}%`
})

//change progress bar on click
progress.addEventListener('click', (e) =>{
  const progressTime = (e.offsetX / progress.offsetWidth) * video.duration
  video.currentTime = progressTime
})

</script>
</body>
</html>
-->
 <!--
<button type="button" onclick="document.write(5 + 6)">Try it</button>
  <div onclick="console.log('first div')">
  <div onclick="console.log('second div')">
    <button onclick="sendMsg()">Send to Server</button>
  </div>
</div>
<div onclick="console.log('div')">
  <p onclick="console.log('p')">
<p id="demo"></p>
    Click here!
<button onclick="myFunction()">Click paste me</button>
  </p>
</div>

  function myFunction() {
        let val =  document.getElementById("fnamed").value; 
        // alert(val);
        document.getElementById("demo").innerHTML = val.concat("KK0");
        console.log("myFunction Executed", "  xxcc");
      }

    function sendMsg() {
      console.log("Function Click: "+document.getElementById("fnamed").value);
      let payload = "Message from Client: "+document.getElementById("fnamed").value;
      ws.send(payload);
    }


      <div class="player-controls">
        <div class="video-progress">
          <div class="video-progress-filled"></div>
        </div>

        <button class="play-button" title="Play">►</button>

        <input
          type="range"
          class="volume"
          min="0"
          max="1"
          step="0.01"
          value="1"
        />

        <div class="time">
          <span class="current">0:00</span> / <span class="duration">0:00</span>
        </div>



      </div>
    
   sharing: {
    sites: ["facebook","twitter","email","linkedin","pinterest"]
  },
  intl: {
    en: {
      sharing: {
        heading: "Share this awesome video"
      }
    }
  }



const faces = ["😁", "🥳", "😎"];

const flags = ["🏴‍☠️", "🏁", "🏳️‍🌈"];

const fruits = ["🍊", "🍌", "🍎"];

const mergedArrays = [...faces, ...flags, ...fruits];

console.log(mergedArrays);-->